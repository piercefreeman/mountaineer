
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../database_migrations/">
      
      
        <link rel="next" href="../links/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Error Handling - Mountaineer</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe+UI,Roboto,Helvetica+Neue,Arial,Noto+Sans,sans-serif,Apple+Color+Emoji,Segoe+UI+Emoji,Segoe+UI+Symbol,Noto+Color+Emoji:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#error-handling" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Mountaineer" class="md-header__button md-logo" aria-label="Mountaineer" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mountaineer
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Error Handling
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Mountaineer" class="md-nav__button md-logo" aria-label="Mountaineer" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Mountaineer
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mountaineer
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Mountaineer App
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Learn
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Learn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../views/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Views &amp; Layouts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client Actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Page Metadata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database_migrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Migrations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Error Handling
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Error Handling
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#client-server-exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      Client-&gt;Server exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Errors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssr-timeouts" class="md-nav__link">
    <span class="md-ellipsis">
      SSR timeouts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssr-exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      SSR exceptions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Links
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../static_analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Static Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postcss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PostCSS &amp; Tailwind
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/app-controller/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    App Controller
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/controller/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    View Controller
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/api_exception/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Exception
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/render/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Render
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/core_dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core Dependencies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/watch_server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Watch server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/ssr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_12" >
        
          
          <label class="md-nav__link" for="__nav_5_12" id="__nav_5_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Database
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_12">
            <span class="md-nav__icon md-icon"></span>
            Database
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/database/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/database/dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Dependencies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/database/migrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Migrations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_13" >
        
          
          <label class="md-nav__link" for="__nav_5_13" id="__nav_5_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Build Plugins
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_13">
            <span class="md-nav__icon md-icon"></span>
            Build Plugins
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/build_plugins/postcss/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PostCSS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/build_plugins/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build Plugin Base
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Internal
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Internal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../internal/core_library/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core Library
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#client-server-exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      Client-&gt;Server exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Errors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssr-timeouts" class="md-nav__link">
    <span class="md-ellipsis">
      SSR timeouts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssr-exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      SSR exceptions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="error-handling">Error Handling</h1>
<p>Errors are a fundamental part of computer science, but nowhere is that more evident than when building websites. There are so many factors you don't have control over: client latency, malformed payloads, spiky server load, resource contention for the same user. The list goes on. Any one can bring a user experience to its knees.</p>
<p>All that to say - it's not a question of <em>if</em> you'll see errors but <em>when</em>. Mountaineer provides some handy utilities that make it a bit easier to handle the errors you may encounter in production.</p>
<h2 id="client-server-exceptions">Client-&gt;Server exceptions</h2>
<p>When client actions call server actions (either sideeffects or passthroughs), their browser needs to make an outgoing fetch request to your server. Your server can throw an error in response to this payload for any reason: validation failures, unexpected state, or just because some internal logic failed.</p>
<p>When your server returns an error, your async action will raise the relevant error. Let's say you have the following component that issues an invalid call to a server action:</p>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="nx">button</span>
<span class="w">  </span><span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">serverState</span><span class="p">.</span><span class="nx">increment_count</span><span class="p">({</span>
<span class="w">      </span><span class="nx">requestBody</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// @ts-ignore</span>
<span class="w">        </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;invalid payload&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}}</span>
<span class="o">&gt;</span>
<span class="w">  </span><span class="nx">Invalid</span><span class="w"> </span><span class="nx">Increment</span>
<span class="o">&lt;</span><span class="err">/button&gt;</span>
</code></pre></div>
<p>When this button is clicked, it will send an <code>increment_count</code> action to the server. The server will validate the incoming payload with Pydantic, which will throw a <a href="https://docs.pydantic.dev/latest/errors/validation_errors/">ValidationError</a> since it expects <code>count</code> to be an integer, not a string. The server will then respond with a 422 validation error, which will be passed back to the client and raised in the async function. You can catch this error with a try/catch block:</p>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">HTTPValidationErrorException</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./_server/actions&quot;</span><span class="p">;</span>

<span class="p">...</span>

<span class="o">&lt;</span><span class="nx">button</span>
<span class="w">  </span><span class="nx">className</span><span class="o">=</span><span class="s2">&quot;rounded-md bg-blue-500 p-2 text-white&quot;</span>
<span class="w">  </span><span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">serverState</span><span class="p">.</span><span class="nx">increment_count</span><span class="p">({</span>
<span class="w">        </span><span class="nx">requestBody</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// @ts-ignore</span>
<span class="w">          </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;invalid payload&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">HTTPValidationErrorException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">          </span><span class="s2">&quot;Validation Error&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">error</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">detail</span><span class="o">?</span><span class="p">.[</span><span class="mf">0</span><span class="p">].</span><span class="nx">loc</span><span class="p">,</span>
<span class="w">          </span><span class="nx">error</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">detail</span><span class="o">?</span><span class="p">.[</span><span class="mf">0</span><span class="p">].</span><span class="nx">msg</span><span class="p">,</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="nx">error</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}}</span>
<span class="o">&gt;</span>
<span class="w">  </span><span class="nx">Invalid</span><span class="w"> </span><span class="nx">Increment</span>
<span class="o">&lt;</span><span class="err">/button&gt;</span>
</code></pre></div>
<p>Mountaineer will convert the error into a custom error class and expose it in <code>_server/actions</code> for you to import. This class helps you switch logic depending on the type of error that was raised. Using a class here also has the benefit of typeguarding your error handling, so you'll see IDE recommendations specific to that ValidationError.</p>
<p>You can find the error payload itself within <code>error.body</code>, which will be typehinted with all the metadata (if any) that the server is expected to return as part of this error code. In the above example, that looks like this:</p>
<div class="highlight"><pre><span></span><code>Validation Error (2) [&#39;body&#39;, &#39;count&#39;] Input should be a valid integer, unable to parse string as an integer
</code></pre></div>
<p>Internally, we generate <code>HTTPValidationErrorException</code> as a subclass of FetchErrorBase. This provided the common error handling, while typehinting it for your specific API errors.</p>
<div class="highlight"><span class="filename">_server/actions.ts</span><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nx">HTTPValidationErrorException</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">FetchErrorBase</span><span class="o">&lt;</span><span class="nx">HTTPValidationError</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For more information on error typehinting and custom handling, see the FastAPI <a href="https://fastapi.tiangolo.com/tutorial/handling-errors/">documentation</a>.</p>
</div>
<h2 id="custom-errors">Custom Errors</h2>
<p>A 422 ValidationError is a special error that is included in every action, because your function signature is verified every time a client sends a new payload to your server. To implement a custom error that is specific to your application, you can subclass <code>APIException</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">mountaineer.exceptions</span> <span class="kn">import</span> <span class="n">APIException</span>

<span class="k">class</span> <span class="nc">LoginInvalid</span><span class="p">(</span><span class="n">APIException</span><span class="p">):</span>
    <span class="n">status_code</span> <span class="o">=</span> <span class="mi">401</span>
    <span class="n">invalid_reason</span><span class="p">:</span> <span class="nb">str</span>

<span class="k">class</span> <span class="nc">LoginController</span><span class="p">(</span><span class="n">ControllerBase</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="nd">@passthrough</span><span class="p">(</span><span class="n">exception_models</span><span class="o">=</span><span class="p">[</span><span class="n">LoginInvalid</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">login_payload</span><span class="p">:</span> <span class="n">LoginRequest</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">LoginInvalid</span><span class="p">(</span><span class="n">invalid_reason</span><span class="o">=</span><span class="s2">&quot;Login not implemented&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Provide all the exceptions that your function may throw to <code>@passthrough(exception_models=[])</code>. The <code>@sideeffect</code> decorator accepts the same argument.</p>
<p>When specified like this, Mountaineer turns your exception into a client-side exception just like <code>HTTPValidationErrorException</code>. You can now use it in the same way.</p>
<h2 id="ssr-timeouts">SSR timeouts</h2>
<p>To render each page on the server side, we have to execute your view's Javascript in a V8 engine. This is the same Javascript interpreter that powers Chrome. As such, you have the full freedom to write any Javascript in your view that will help you render your page - loops, calculations, package calls, etc.</p>
<p>As is the case with Turing-complete languages, with great power comes great responsibility.</p>
<p>These SSR requests can potentially take a long time. At the extreme, they could even clog up your server by infinite looping and never returning a value. We have a series of safeguards in place to help ensure SSR renders return quickly and keep your server able to chug through additional requests.</p>
<ul>
<li>Debug logging of the duration of each SSR page render, for use in development.</li>
<li>Warning logs if rendering takes longer than some interval so you can keep an eye on endpoints that might need some optimization.</li>
<li>Hard timeouts for rendering. If something goes sideways and your server rendering takes longer a maximum threshold, we'll terminate the server-side Javascript executor for you and return an error to the client.</li>
</ul>
<h2 id="ssr-exceptions">SSR exceptions</h2>
<p>Alongside timeouts, it's possible your view's Javascript actually gets into an unrecoverable state and throws an exception during rendering. To help you debug this on the server side, we'll raise this error as a <code>mountaineer.ssr.V8RuntimeError</code> and log the stack trace that comes back from the V8 engine.</p>
<p>The paths reported in the stack trace are found from the sourcemap that's created alongside the compiled SSR files. These should point to the files in your view directory that have produced that exception.</p>
<div class="highlight"><pre><span></span><code><span class="o">{</span><span class="s2">&quot;level&quot;</span>:<span class="w"> </span><span class="s2">&quot;ERROR&quot;</span>,<span class="w"> </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;mountaineer.logging&quot;</span>,<span class="w"> </span><span class="s2">&quot;message&quot;</span>:<span class="w"> </span><span class="s2">&quot;Exception encountered in ComplexController rendering&quot;</span><span class="o">}</span>
ERROR:<span class="w">    </span>Exception<span class="w"> </span><span class="k">in</span><span class="w"> </span>ASGI<span class="w"> </span>application
Traceback<span class="w"> </span><span class="o">(</span>most<span class="w"> </span>recent<span class="w"> </span>call<span class="w"> </span>last<span class="o">)</span>:
<span class="w">  </span>File<span class="w"> </span><span class="s2">&quot;/Users/piercefreeman/projects/mountaineer/mountaineer/ssr.py&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">37</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>render_ssr
<span class="w">    </span><span class="nv">render_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>mountaineer_rs.render_ssr<span class="o">(</span>
<span class="w">                    </span>^^^^^^^^^^^^^^^^^^^^
...

<span class="w"> </span>File<span class="w"> </span><span class="s2">&quot;/Users/piercefreeman/projects/mountaineer/mountaineer/ssr.py&quot;</span>,<span class="w"> </span>line<span class="w"> </span><span class="m">43</span>,<span class="w"> </span><span class="k">in</span><span class="w"> </span>render_ssr
<span class="w">   </span>raise<span class="w"> </span>V8RuntimeError<span class="o">(</span>e<span class="o">)</span>
mountaineer.ssr.V8RuntimeError:<span class="w"> </span>Error<span class="w"> </span>calling<span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="s1">&#39;Index&#39;</span>:<span class="w"> </span>Error:<span class="w"> </span>Example<span class="w"> </span>client<span class="w"> </span>error
Stack:<span class="w"> </span>Error:<span class="w"> </span>Example<span class="w"> </span>client<span class="w"> </span>error
<span class="w">    </span>at<span class="w"> </span>Page<span class="w"> </span><span class="o">(</span>./my_website/views/app/complex/page.tsx:41:10<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>renderWithHooks<span class="w"> </span><span class="o">(</span>./my_website/views/node_modules/react-dom/cjs/react-dom-server-legacy.browser.development.js:5660:15<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>renderIndeterminateComponent<span class="w"> </span><span class="o">(</span>./my_website/views/node_modules/react-dom/cjs/react-dom-server-legacy.browser.development.js:5733:14<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>renderElement<span class="w"> </span><span class="o">(</span>&lt;anonymous&gt;:6537:17<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>renderNodeDestructiveImpl<span class="w"> </span><span class="o">(</span>&lt;anonymous&gt;:6642:19<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>renderNodeDestructive<span class="w"> </span><span class="o">(</span>./my_website/views/node_modules/react-dom/cjs/react-dom-server-legacy.browser.development.js:6078:13<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>renderIndeterminateComponent<span class="w"> </span><span class="o">(</span>&lt;anonymous&gt;:6417:17<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>renderElement<span class="w"> </span><span class="o">(</span>&lt;anonymous&gt;:6537:17<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>renderNodeDestructiveImpl<span class="w"> </span><span class="o">(</span>&lt;anonymous&gt;:6642:19<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>renderNodeDestructive<span class="w"> </span><span class="o">(</span>./my_website/views/node_modules/react-dom/cjs/react-dom-server-legacy.browser.development.js:6078:13<span class="o">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <div class="mountaineer-footer">
    <center>Move fast. Climb mountains. Don't break things.</center>
</div>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>